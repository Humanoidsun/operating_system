# 操作系统的发展方向
Linux 0.11 是一个汇聚了无数人智慧结晶才诞生的产物，其已经是一个无比精妙的系统了。

不过现在距离 Linux0.11 的诞生已经过去几十年了，操作系统和硬件虽然没有什么彻头彻尾的变动，但是很多方面做的却比以前更加完美了，当然完美的代价是代码变得极其复杂，晦涩难懂，这里不展开源码讲解，我想大概谈一谈这些变动的大方向。

核心的大方向其实也就只有两个，一个是减少没有必要的资源消耗，二是增加在进程和操作系统中间的一层隔离，即：容器。

- 减少没有必要的资源消耗
    - 减少 CPU 消耗：这块含有如下两个方面
        - 硬件方面：
           - X86 将指令翻译为 精简指令集 再使用流水线；
           - MESI 协议 与 InvalidateQueue及WriteBuffer 的结合；
           - 更丰富的DMA模块。
           - 减少系统调用本身的消耗，从 INT 中断发起系统调用 到 sysent 发起系统调用。
           - ......
        - 软件方面：
           - 减少系统调用次数：关于减少系统调用次数，基本上有三种思路：
               - 第一种思路：没有必要进行系统调用时，就不进行系统调用，实在需要系统调用时，再进行系统调用，这一类大多借助 mmap 的思想，创建共享内存，将一部分内核空间的访问权限交给用户空间，仅把需要保护的操作保护起来有：
                   - 从 poll 到 select 再到 epoll 
                   - 从 信号量 到 futex（仅在线程需要暂停或者继续时，才需要系统调用来进入内核态）
                   - ......
               - 第二种思路：彻底不进行系统调用，这种思路比较激进，属于一种比较偏激的做法，但是也有用，如：DPDK
               - 第三种思路：将一部分安全的用户态代码放入内核态执行，eBPF（被誉为操作系统近50年来最大的改动）
    - 减少内存消耗：内核从一开始内存分配至少一页，变为可以根据不同大小的需求分配内存，发展出 buddy 内存管理系统，针对不同大小均可快速分配相应大小的内存，如：slab等等。

- 容器技术：
    - namespace
    - cgroup
    - chroot
